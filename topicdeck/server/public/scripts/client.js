!function(){"use strict";let DOMParser=eval("window.DOMParser");var fetch$1=eval("self.fetch"),WritableStream=eval("self.WritableStream"),ReadableStream=eval("self.ReadableStream"),Request=eval("self.Request"),Response=eval("self.Response"),caches$1=eval("self.caches");const CommonDOMParser=DOMParser,findNode=(e,t)=>{let n;for(let o=0;o<t.length;o++)if((n=t[o]).tagName==e)return n},findNodes=(e,t)=>{const n=[];let o;for(let i=0;i<t.length;i++)(o=t[i]).tagName==e&&n.push(o);return n},hardSanitize=(e,t)=>{t=t||100;let n=!1;const o=[];for(let i of e){if(o.length>t)break;"<"!=i?">"!=i||1!=n?"\n"!=i&&"\r"!=i&&(n||o.push(i)):n=!1:n=!0}return o.join("")},findElementText=(e,t)=>{const n=findNodes(e,t.childNodes);return n&&n.length>0?n[0].textContent:""},findElementAttribute=(e,t,n)=>{const o=findNodes(e,n.childNodes);if(o&&o.length>0){const e=o[0].attributes.getNamedItem(t);return void 0!==e?e.value:""}return""},attributeEquals=(e,t)=>n=>{const o=n.attributes.getNamedItem(e);return o&&o.value===t},convertFeedItemsToJSON=e=>{if(void 0===e)return[];const t=(new CommonDOMParser).parseFromString(e,"application/xml").documentElement,n={};if(null===t)return[];if("rss"===t.nodeName){const e=findNode("channel",t.childNodes),o=findElementText("title",e),i=findElementText("link",e),r=findNodes("item",e.childNodes);return n.title=o,n.link=i,r.map(e=>convertRSSItemToJSON(e,n))}if("feed"===t.nodeName){const e=findNodes("entry",t.childNodes),o=findElementText("title",t),i="";findNodes("link",t).filter(attributeEquals("rel","self"))[0];return n.title=o,n.link=i,e.map(e=>convertAtomItemToJSON(e,n))}return[]},convertAtomItemToJSON=(e,t)=>{const n=findElementText("title",e),o=findElementText("summary",e),i=findElementText("id",e),r=findElementText("updated",e),l=findElementText("author",e)||findElementText("dc:creator",e)||t.title,s=findElementAttribute("link","href",e);return{title:hardSanitize(n,400),guid:i,description:hardSanitize(o,100),pubDate:r,author:l,link:s}},convertRSSItemToJSON=(e,t)=>{const n=findElementText("title",e),o=findElementText("description",e),i=findElementText("guid",e),r=findElementText("pubDate",e)||findElementText("a10:updated",e),l=findElementText("author",e)||findElementText("dc:creator",e)||t.title,s=findElementText("link",e),d=findElementText("content:encoded",e);return{title:hardSanitize(n,400),guid:i,description:hardSanitize(o,100),"content:encoded":hardSanitize(d,100),pubDate:r,author:l,link:s}};!function(){if("serviceWorker"in navigator&&window.addEventListener("load",function(){navigator.serviceWorker.register("/sw.js").then(function(e){console.log("ServiceWorker registration successful with scope: ",e.scope)},function(e){console.log("ServiceWorker registration failed: ",e)})}),"BroadcastChannel"in window){new BroadcastChannel("install-cache-channel").onmessage=(e=>{console.log(e);const t=document.getElementById("toast");t.classList.add("visible"),setTimeout(()=>t.classList.remove("visible"),1e4)})}const e=(e,t)=>{const n=e.content.cloneNode(!0),o=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT,()=>NodeFilter.FILTER_ACCEPT);for(;o.nextNode();){const e=o.currentNode;for(const n in e.dataset){if(0==n.indexOf("bind_")){const o=e.dataset[n].split("|"),i=n.substr(5);for(const n of o)if(n in t&&""!==t[n]){e[i]=t[n];break}}}}return n};!function(e,t){const n=document.querySelectorAll(e);n&&t(Array.prototype.slice.call(n)),new MutationObserver(function(n){n.forEach(function(n){let o=Array.prototype.slice.call(n.addedNodes),i=[];for(let t of o)t.matches&&1==t.nodeType&&t.matches(e)&&i.push(t);t(i)})}).observe(document.documentElement,{childList:!0,subtree:!0})}("section div[data-url]",t=>{const n=document.getElementById("itemTemplate");for(const o of t){const t=o.dataset.url,i=`/proxy?url=${encodeURIComponent(t)}`;fetch(i).then(e=>{const t=e.clone();return"caches"in window?caches.open("data").then(n=>(n&&n.put(i,t),e.text())):e.text()}).then(e=>convertFeedItemsToJSON(e)).then(e=>e.reverse()).then(e=>e.filter(e=>!document.getElementById(e.guid))).then(t=>t.map(t=>e(n.cloneNode(!0),t))).then(e=>e.forEach(e=>o.insertBefore(e,o.firstChild)))}}),document.addEventListener("click",e=>{const t=e.target;if("svg"===t.nodeName&&t.classList.contains("share")){e.preventDefault();const n=t.getAttribute("url")||"",o=t.getAttribute("title")||"";if(navigator.share)navigator.share({url:n,title:o,text:o});else{const e="scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=520,height=420",t=`https://twitter.com/intent/tweet?text=${encodeURIComponent(o)}&url=${encodeURIComponent(n)}`;window.open(t,"intent",e)}}}),document.addEventListener("keyup",e=>{const t=document.querySelectorAll("section"),n=document.querySelector("section.selected");let o;"ArrowLeft"==e.code?!1==!!n?o=t[t.length-1]:(n.classList.remove("selected"),o=n.previousElementSibling?n.previousElementSibling:t[t.length-1]):"ArrowRight"==e.code&&(!1==!!n?o=t[0]:(n.classList.remove("selected"),o=n.nextElementSibling?n.nextElementSibling:t[0])),o&&(o.classList.add("selected"),o.scrollIntoView({behaviour:"smooth"}))})}()}();
